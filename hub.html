<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>DIGIY HUB ‚Äî Super App S√©n√©gal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="DIGIY HUB ‚Äî La Super-App africaine : DRIVER, POS, LOC, PAY, MARKET. 0% commission, souverainet√© num√©rique.">
  <meta name="theme-color" content="#022c22">

  <style>
    :root{
      --bg:#020617;
      --bg-soft:#020818;
      --card:#030712;
      --card-alt:#020617;
      --accent:#facc15;
      --accent-soft:#f97316;
      --accent-soft2:#22c55e;
      --ink:#f9fafb;
      --muted:#9ca3af;
      --line:#1f2937;
      --danger:#ef4444;
      --good:#22c55e;
      --info:#38bdf8;
      --radius-xl:22px;
      --radius-lg:16px;
      --radius-md:12px;
      --shadow-soft:0 22px 45px rgba(15,23,42,0.9);
    }

    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:-apple-system, BlinkMacSystemFont, system-ui, "Segoe UI", sans-serif;
    }

    body{
      min-height:100vh;
      background:
        radial-gradient(circle at top left, rgba(34,197,94,0.18), transparent 60%),
        radial-gradient(circle at bottom right, rgba(250,204,21,0.16), transparent 55%),
        #020617;
      color:var(--ink);
      display:flex;
      justify-content:center;
      padding:10px;
    }

    .app{
      width:100%;
      max-width:1120px;
      min-height:100vh;
      background:
        radial-gradient(circle at 0% 0%, rgba(34,197,94,0.14), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(250,204,21,0.12), transparent 55%),
        linear-gradient(145deg, #020617, #020819);
      border-radius:26px;
      border:1px solid rgba(148,163,184,0.35);
      box-shadow:var(--shadow-soft);
      padding:14px 14px 18px;
      display:flex;
      flex-direction:column;
      position:relative;
      overflow:hidden;
    }

    @media(max-width:800px){
      body{
        padding:0;
        background:#020617;
      }
      .app{
        border-radius:0;
        border:none;
        box-shadow:none;
      }
    }

    /* HEADER */

    header{
      position:relative;
      z-index:10;
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .brand-logo{
      width:40px;
      height:40px;
      border-radius:14px;
      background:
        radial-gradient(circle at 30% 0%, #facc15, #f97316);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      font-weight:900;
      color:#022c22;
      box-shadow:0 0 22px rgba(250,204,21,0.55);
      border:1px solid rgba(250,204,21,0.8);
    }

    .brand-text-title{
      font-size:15px;
      font-weight:800;
      letter-spacing:0.1em;
      text-transform:uppercase;
      color:var(--accent);
    }

    .brand-text-sub{
      font-size:11px;
      color:var(--muted);
    }

    .header-right{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .menu-btn{
      width:34px;
      height:34px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.55);
      background:rgba(15,23,42,0.95);
      color:var(--ink);
      font-size:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
    }

    .user-pill{
      display:flex;
      align-items:center;
      gap:8px;
      background:rgba(15,23,42,0.95);
      padding:6px 11px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      min-width:0;
      transition:box-shadow 0.25s ease, border-color 0.25s ease;
    }

    .user-pill.admin-mode{
      border-color:rgba(250,204,21,0.9);
      box-shadow:0 0 22px rgba(250,204,21,0.55);
    }

    .user-avatar{
      width:26px;
      height:26px;
      border-radius:999px;
      background:linear-gradient(135deg, #22c55e, #16a34a);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:14px;
      color:#022c22;
      flex-shrink:0;
    }

    .user-avatar.admin-mode{
      background:linear-gradient(135deg,#facc15,#f97316);
      color:#111827;
      box-shadow:0 0 18px rgba(250,204,21,0.9);
    }

    .user-meta{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }

    .user-name{
      font-size:12px;
      font-weight:600;
      white-space:nowrap;
      text-overflow:ellipsis;
      overflow:hidden;
      max-width:130px;
    }

    .user-role{
      font-size:10px;
      color:var(--muted);
    }

    .logout-btn{
      border:none;
      background:transparent;
      color:var(--muted);
      font-size:14px;
      cursor:pointer;
      padding-left:4px;
    }

    @media(max-width:600px){
      .user-name{max-width:90px;}
    }

    /* SIDE MENU */

    .side-menu-overlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,0.7);
      backdrop-filter:blur(6px);
      opacity:0;
      pointer-events:none;
      transition:opacity 0.25s ease;
      z-index:40;
    }

    .side-menu-overlay.open{
      opacity:1;
      pointer-events:auto;
    }

    .side-menu{
      position:fixed;
      inset:0 auto 0 0;
      width:260px;
      max-width:80%;
      background:radial-gradient(circle at top left, rgba(250,204,21,0.12), transparent 70%),
                 #020617;
      border-right:1px solid rgba(148,163,184,0.45);
      transform:translateX(-100%);
      transition:transform 0.25s ease;
      box-shadow:16px 0 35px rgba(15,23,42,0.9);
      padding:14px 12px;
      z-index:50;
    }

    .side-menu.open{
      transform:translateX(0);
    }

    .side-menu-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }

    .side-menu-title{
      font-size:13px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:var(--accent);
    }

    .side-menu-close{
      border:none;
      background:transparent;
      color:var(--muted);
      font-size:20px;
      cursor:pointer;
    }

    .side-menu-section-title{
      font-size:11px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:0.12em;
      margin:10px 0 6px;
    }

    .side-menu-list{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .side-menu-item{
      display:flex;
      align-items:center;
      gap:8px;
      padding:7px 8px;
      border-radius:999px;
      cursor:pointer;
      border:1px solid transparent;
      font-size:11px;
      color:var(--muted);
    }

    .side-menu-item:hover{
      border-color:rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.85);
      color:var(--ink);
    }

    .side-menu-icon{
      width:22px;
      height:22px;
      border-radius:999px;
      background:rgba(15,23,42,1);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:13px;
    }

    .side-menu-footer{
      margin-top:16px;
      font-size:10px;
      color:var(--muted);
    }

    /* WELCOME */

    .welcome{
      position:relative;
      z-index:5;
      background:radial-gradient(circle at top left, rgba(34,197,94,0.25), transparent 55%),
                 radial-gradient(circle at top right, rgba(250,204,21,0.25), transparent 55%),
                 rgba(3,7,18,0.92);
      border-radius:var(--radius-xl);
      border:1px solid rgba(148,163,184,0.4);
      padding:12px 12px 10px;
      margin-bottom:10px;
      overflow:hidden;
    }

    .welcome-top{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
    }

    .welcome-title{
      font-size:15px;
      font-weight:700;
    }

    .welcome-sub{
      font-size:11px;
      color:var(--muted);
      margin-top:2px;
    }

    .welcome-badge{
      font-size:10px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(250,204,21,0.7);
      background:rgba(15,23,42,0.9);
      display:inline-flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }

    .welcome-dot{
      width:8px;
      height:8px;
      border-radius:999px;
      background:radial-gradient(circle, #22c55e, #16a34a);
      box-shadow:0 0 10px rgba(34,197,94,1);
    }

    .welcome-tags{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:6px;
    }

    .welcome-tag{
      font-size:10px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      color:var(--muted);
      background:rgba(15,23,42,0.85);
    }

    /* MAIN GRID */

    main{
      position:relative;
      z-index:5;
      flex:1;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .grid{
      display:grid;
      grid-template-columns:2.1fr 3.1fr;
      gap:10px;
    }

    @media(max-width:860px){
      .grid{
        grid-template-columns:1fr;
      }
    }

    .card{
      background:radial-gradient(circle at top, rgba(15,23,42,0.96), #020617);
      border-radius:var(--radius-xl);
      border:1px solid rgba(30,64,175,0.5);
      padding:12px;
      box-shadow:0 14px 36px rgba(15,23,42,0.9);
      position:relative;
      overflow:hidden;
    }

    .card-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:7px;
    }

    .card-title{
      font-size:13px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:var(--muted);
    }

    .card-pill{
      font-size:10px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      color:var(--muted);
    }

    /* WALLET */

    .wallet-main{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .wallet-balance{
      font-size:24px;
      font-weight:800;
    }

    .wallet-label{
      font-size:11px;
      color:var(--muted);
    }

    .wallet-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:5px;
      gap:8px;
    }

    .wallet-meta{
      font-size:10px;
      color:var(--muted);
      display:flex;
      flex-direction:column;
      gap:2px;
    }

    .wallet-actions{
      display:flex;
      flex-wrap:wrap;
      gap:7px;
    }

    .btn{
      border:none;
      border-radius:999px;
      padding:6px 11px;
      font-size:11px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:5px;
      white-space:nowrap;
    }

    .btn-primary{
      background:linear-gradient(135deg, #22c55e, #16a34a);
      color:#022c22;
      font-weight:600;
    }

    .btn-gold{
      background:linear-gradient(135deg, #facc15, #f97316);
      color:#111827;
      font-weight:600;
    }

    .btn-ghost{
      background:rgba(15,23,42,0.9);
      color:var(--muted);
      border:1px solid rgba(148,163,184,0.5);
    }

    .wallet-foot{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:7px;
      font-size:10px;
      color:var(--muted);
      flex-wrap:wrap;
      gap:6px;
    }

    .status-dot{
      width:8px;
      height:8px;
      border-radius:999px;
      background:var(--good);
      box-shadow:0 0 10px rgba(34,197,94,1);
      margin-right:4px;
      display:inline-block;
    }

    .status-dot.offline{
      background:var(--danger);
      box-shadow:0 0 10px rgba(239,68,68,0.9);
    }

    /* MODULES */

    .modules{
      display:grid;
      grid-template-columns:repeat(3, minmax(0,1fr));
      gap:8px;
    }

    @media(max-width:980px){
      .modules{
        grid-template-columns:repeat(2, minmax(0,1fr));
      }
    }

    @media(max-width:640px){
      .modules{
        grid-template-columns:repeat(2, minmax(0,1fr));
      }
    }

    .module{
      background:radial-gradient(circle at top, rgba(15,23,42,0.98), #020617);
      border-radius:var(--radius-lg);
      border:1px solid rgba(30,64,175,0.7);
      padding:8px 8px 9px;
      position:relative;
      overflow:hidden;
    }

    .module.admin-core{
      border-color:rgba(250,204,21,0.9);
      box-shadow:0 0 18px rgba(250,204,21,0.5);
    }

    .module::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:radial-gradient(circle at top, rgba(250,204,21,0.1), transparent 60%);
      opacity:0.8;
      pointer-events:none;
    }

    .module-inner{
      position:relative;
      z-index:2;
    }

    .module-header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:7px;
    }

    .module-left{
      display:flex;
      align-items:flex-start;
      gap:7px;
    }

    .module-icon{
      width:26px;
      height:26px;
      border-radius:12px;
      background:rgba(15,23,42,0.95);
      border:1px solid rgba(148,163,184,0.6);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
      flex-shrink:0;
    }

    .module-titles{
      flex:1;
      min-width:0;
    }

    .module-name{
      font-size:12px;
      font-weight:700;
    }

    .module-tagline{
      font-size:10px;
      color:var(--muted);
    }

    .module-badge{
      font-size:9px;
      padding:3px 6px;
      border-radius:999px;
      border:1px solid rgba(34,197,94,0.9);
      color:var(--good);
      background:rgba(15,23,42,0.9);
      white-space:nowrap;
    }

    .module-badge-soon{
      border-color:rgba(250,204,21,0.9);
      color:var(--accent);
    }

    .module-body{
      font-size:10px;
      color:var(--muted);
      margin-top:4px;
      min-height:28px;
    }

    .module-foot{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:5px;
      font-size:9px;
      color:var(--muted);
      gap:5px;
    }

    .module-btn{
      border:none;
      border-radius:999px;
      padding:4px 8px;
      font-size:10px;
      cursor:pointer;
      background:linear-gradient(135deg, #facc15, #f97316);
      color:#020617;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:4px;
      white-space:nowrap;
    }

    .module-mini{
      font-size:9px;
      color:var(--muted);
      text-align:right;
      flex:1;
    }

    footer{
      position:relative;
      z-index:5;
      margin-top:10px;
      font-size:9px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      gap:8px;
      flex-wrap:wrap;
    }

    footer span{
      color:var(--accent);
    }

    footer strong{
      color:var(--accent-soft2);
    }
  </style>
</head>
<body>

<div class="side-menu-overlay" id="sideMenuOverlay" onclick="closeSideMenu()"></div>

<div class="side-menu" id="sideMenu">
  <div class="side-menu-header">
    <div class="side-menu-title">Menu DIGIY HUB</div>
    <button class="side-menu-close" onclick="closeSideMenu()">‚úï</button>
  </div>

  <div class="side-menu-section-title">Compte</div>
  <div class="side-menu-list">
    <div class="side-menu-item" onclick="scrollToTop()">
      <div class="side-menu-icon">üë§</div>
      <div>Profil DIGIY (depuis l‚Äôinscription)</div>
    </div>
    <div class="side-menu-item" onclick="logoutUser()">
      <div class="side-menu-icon">‚èè</div>
      <div>Se d√©connecter</div>
    </div>
  </div>

  <div class="side-menu-section-title">Modules</div>
  <div class="side-menu-list">
    <div class="side-menu-item" onclick="openModule('driver')">
      <div class="side-menu-icon">üöó</div>
      <div>DIGIY DRIVER ‚Ä¢ Client</div>
    </div>
    <div class="side-menu-item" onclick="openModule('driverTop')">
      <div class="side-menu-icon">üöñ</div>
      <div>DIGIY DRIVER ‚Ä¢ Chauffeur</div>
    </div>
    <div class="side-menu-item" onclick="openModule('loc')">
      <div class="side-menu-icon">üè°</div>
      <div>DIGIY LOC</div>
    </div>
    <div class="side-menu-item" onclick="openModule('pos')">
      <div class="side-menu-icon">üßæ</div>
      <div>DIGIY POS</div>
    </div>
    <div class="side-menu-item" onclick="openModule('pay')">
      <div class="side-menu-icon">üí≥</div>
      <div>DIGIY PAY</div>
    </div>
    <div class="side-menu-item" onclick="openModule('market')">
      <div class="side-menu-icon">üõí</div>
      <div>DIGIY MARKET</div>
    </div>
    <div class="side-menu-item" onclick="openModule('core')">
      <div class="side-menu-icon">üß†</div>
      <div>DIGIY CORE</div>
    </div>
  </div>

  <div class="side-menu-section-title">Vision</div>
  <div class="side-menu-footer">
    DIGIY HUB ‚Äî Ind√©pendance financi√®re, donn√©es souveraines.<br>
    0% commission ‚Ä¢ Peuple ‚Üí Pro, sans interm√©diaires toxiques.
  </div>
</div>

<div class="app">

  <header>
    <div class="brand">
      <div class="brand-logo">‚àû</div>
      <div>
        <div class="brand-text-title">DIGIY HUB</div>
        <div class="brand-text-sub">Super App ‚Äî S√©n√©gal ‚Ä¢ Afrique</div>
      </div>
    </div>

    <div class="header-right">
      <button class="menu-btn" onclick="openSideMenu()">‚ò∞</button>
      <div class="user-pill" id="userPill">
        <div class="user-avatar" id="userAvatar">üë§</div>
        <div class="user-meta">
          <div class="user-name" id="userName">Invit√© DIGIY</div>
          <div class="user-role" id="userRole">Connectez-vous depuis la page d‚Äôinscription</div>
        </div>
        <button class="logout-btn" onclick="logoutUser()" title="Changer de compte">‚èè</button>
      </div>
    </div>
  </header>

  <main>
    <section class="welcome">
      <div class="welcome-top">
        <div>
          <div class="welcome-title" id="welcomeTitle">
            Bienvenue dans votre HUB DIGIY
          </div>
          <div class="welcome-sub" id="welcomeSub">
            Commander un VTC, g√©rer vos locations, encaisser vos ventes et piloter vos flux depuis un seul endroit.
          </div>
        </div>
        <div class="welcome-badge" id="welcomeBadgeWrapper">
          <span class="welcome-dot"></span>
          <span id="welcomeBadge">Alpha ‚Ä¢ Super App terrain S√©n√©gal</span>
        </div>
      </div>

      <div class="welcome-tags">
        <div class="welcome-tag">0% commission</div>
        <div class="welcome-tag">Paiement direct au pro</div>
        <div class="welcome-tag">Souverainet√© num√©rique</div>
        <div class="welcome-tag">Made in S√©n√©gal</div>
      </div>
    </section>

    <section class="grid">
      <!-- WALLET / PAY -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Wallet DIGIY PAY</div>
          <div class="card-pill" id="walletStatus">Connexion Firebase‚Ä¶</div>
        </div>

        <div class="wallet-main">
          <div class="wallet-balance" id="walletBalance">0 F</div>
          <div class="wallet-label">
            Solde DIGIY PAY ‚Äî reli√© √† votre num√©ro (Firebase). Prototype terrain.
          </div>

          <div class="wallet-row">
            <div class="wallet-meta">
              <span id="walletOwner">Compte : invit√© (pas de t√©l√©phone)</span>
              <span id="lastActivity">Derni√®re action : aucune</span>
            </div>
            <div class="wallet-actions">
              <button class="btn btn-primary" onclick="simulateTopUp(5000)">+5 000 F</button>
              <button class="btn btn-gold" onclick="simulateTopUp(10000)">+10 000 F</button>
              <button class="btn btn-ghost" onclick="resetWallet()">Reset</button>
            </div>
          </div>

          <div class="wallet-foot">
            <div>
              <span class="status-dot offline" id="firebaseStatusDot"></span>
              <span id="firebaseStatusText">Firebase : d√©connect√©</span>
            </div>
            <div>√âtape : <strong>PAY V1 connect√©</strong></div>
          </div>
        </div>
      </div>

      <!-- MODULES HUB -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Modules DIGIY</div>
          <div class="card-pill">Cliquez pour ouvrir un module</div>
        </div>

        <div class="modules">
          <!-- DRIVER CLIENT -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üöó</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY DRIVER ‚Ä¢ Client</div>
                    <div class="module-tagline">Commander une course</div>
                  </div>
                </div>
                <div class="module-badge">0% commission</div>
              </div>
              <div class="module-body">
                VTC terrain : AIBD, Dakar, Petite C√¥te. Paiement direct au chauffeur.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('driver')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">Pour clients & voyageurs</div>
              </div>
            </div>
          </div>

          <!-- DRIVER CHAUFFEUR -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üöñ</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY DRIVER ‚Ä¢ Chauffeur</div>
                    <div class="module-tagline">Interface pro</div>
                  </div>
                </div>
                <div class="module-badge">Pro</div>
              </div>
              <div class="module-body">
                R√©ception de courses, GPS, statuts, historique. Outil d√©di√© chauffeurs DIGIY.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('driverTop')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">Pour chauffeurs inscrits</div>
              </div>
            </div>
          </div>

          <!-- LOC -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üè°</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY LOC</div>
                    <div class="module-tagline">Locations sans OTA</div>
                  </div>
                </div>
                <div class="module-badge">Host friendly</div>
              </div>
              <div class="module-body">
                Exemple : Chez Baptiste. H√©bergements sans plateformes qui mangent la marge.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('loc')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">H√©bergeurs & voyageurs</div>
              </div>
            </div>
          </div>

          <!-- POS -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üßæ</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY POS</div>
                    <div class="module-tagline">Caisse boutique</div>
                  </div>
                </div>
                <div class="module-badge">Terrain</div>
              </div>
              <div class="module-body">
                Caisse DIGIY pour commer√ßants. Tickets, encaissements, statistiques simples.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('pos')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">Boutiques & restos</div>
              </div>
            </div>
          </div>

          <!-- PAY -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üí≥</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY PAY</div>
                    <div class="module-tagline">C≈ìur financier</div>
                  </div>
                </div>
                <div class="module-badge module-badge-soon">Connect√© Firebase</div>
              </div>
              <div class="module-body">
                Wallet reli√© au HUB (Firebase). Demain : Wave, OM, cartes, transferts internes.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('pay')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">Un seul c≈ìur pour tout</div>
              </div>
            </div>
          </div>

          <!-- MARKET -->
          <div class="module">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üõí</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY MARKET</div>
                    <div class="module-tagline">Annonces & services</div>
                  </div>
                </div>
                <div class="module-badge module-badge-soon">Bient√¥t</div>
              </div>
              <div class="module-body">
                Petit ‚ÄúLeboncoin‚Äù s√©n√©galais : annonces, emplois, services, ventes locales.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('market')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini">Pour tout le peuple</div>
              </div>
            </div>
          </div>

          <!-- CORE -->
          <div class="module" id="coreModule">
            <div class="module-inner">
              <div class="module-header">
                <div class="module-left">
                  <div class="module-icon">üß†</div>
                  <div class="module-titles">
                    <div class="module-name">DIGIY CORE</div>
                    <div class="module-tagline">Pilotage global</div>
                  </div>
                </div>
                <div class="module-badge module-badge-soon" id="coreBadge">Admin</div>
              </div>
              <div class="module-body" id="coreBody">
                Tableau de bord ma√Ætre : suivi des modules, flux, revenus, alertes terrain.
              </div>
              <div class="module-foot">
                <button class="module-btn" onclick="openModule('core')">
                  Ouvrir ‚Üí
                </button>
                <div class="module-mini" id="coreMini">Pour la maison m√®re</div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>
  </main>

  <footer>
    <div>
      DIGIY HUB ‚Ä¢ <span>S√©n√©gal ‚Üí Afrique</span> ‚Äî 0% commission, donn√©es souveraines.
    </div>
    <div>
      <strong>Pas d‚ÄôOTA, pas de racket.</strong>  
      Juste le peuple & ses outils.
    </div>
  </footer>
</div>

<!-- Firebase (PAY r√©el) -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>

<script>
  // ===== CONFIG LIENS MODULES =====
  const LINKS = {
    driver: "https://beauville.github.io/digiy-driver-client/",
    driverTop: "https://beauville.github.io/digiy-driver-top/",
    loc: "https://beauville.github.io/chez-baptiste-digiy-loc/",
    pos: "https://beauville.github.io/Caisse-officielle-ASTOU/",
    pay: "#",
    market: "#",
    core: "#"
  };

  const STORAGE_USER_KEY = "digiy_hub_user_v1";
  const STORAGE_WALLET_KEY = "digiy_hub_wallet_v1";

  let currentUser = null;
  let walletBalance = 0;
  let lastActivity = "Aucune activit√©";
  let firebaseDB = null;
  let firebaseReady = false;
  let walletPath = null;

  const firebaseConfig = {
    apiKey: "AIzaSyBqEQWoE2iC7_rp-u4riilNVHolcP2o0B0",
    authDomain: "digiylyfe-ecosystem.firebaseapp.com",
    databaseURL: "https://digiylyfe-ecosystem-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "digiylyfe-ecosystem",
    storageBucket: "digiylyfe-ecosystem.firebasestorage.app",
    messagingSenderId: "1007962643384",
    appId: "1:1007962643384:web:20d26881e87f0dc37d0d4d"
  };

  function initFirebase(){
    const statusDot = document.getElementById("firebaseStatusDot");
    const statusText = document.getElementById("firebaseStatusText");
    const walletStatus = document.getElementById("walletStatus");

    try{
      firebase.initializeApp(firebaseConfig);
      firebaseDB = firebase.database();
      firebaseReady = true;

      statusDot.classList.remove("offline");
      statusText.textContent = "Firebase : connect√©";
      walletStatus.textContent = "Wallet DIGIY PAY reli√© (Firebase)";
    }catch(e){
      console.error("Erreur Firebase HUB:", e);
      firebaseReady = false;
      statusDot.classList.add("offline");
      statusText.textContent = "Firebase : erreur";
      walletStatus.textContent = "Mode d√©mo local (Firebase indisponible)";
    }
  }

  function getWalletPathForUser(user){
    if(!user || !user.phone) return null;
    const phoneKey = String(user.phone).replace(/[^\d+]/g, "");
    if(!phoneKey) return null;
    return "hub_wallets/" + phoneKey;
  }

  function formatCurrency(amount){
    return (amount || 0).toLocaleString("fr-FR") + " F";
  }

  function loadUser(){
    try{
      const raw = localStorage.getItem(STORAGE_USER_KEY);
      if(!raw) return null;
      return JSON.parse(raw);
    }catch(e){
      console.error("Erreur chargement user HUB:", e);
      return null;
    }
  }

  function getRoleLabel(role){
    switch(role){
      case "client": return "Client / voyageur";
      case "chauffeur": return "Chauffeur / driver";
      case "commercant": return "Commer√ßant / POS";
      case "hebergeur": return "H√©bergeur / LOC";
      case "admin": return "Administrateur DIGIY";
      default: return "Profil DIGIY";
    }
  }

  function applyAdminMode(){
    const userPill = document.getElementById("userPill");
    const avatarEl = document.getElementById("userAvatar");
    const welcomeBadge = document.getElementById("welcomeBadge");
    const welcomeSub = document.getElementById("welcomeSub");
    const coreBadge = document.getElementById("coreBadge");
    const coreBody = document.getElementById("coreBody");
    const coreMini = document.getElementById("coreMini");
    const coreModule = document.getElementById("coreModule");

    if(userPill) userPill.classList.add("admin-mode");
    if(avatarEl) avatarEl.classList.add("admin-mode");

    if(welcomeBadge){
      welcomeBadge.textContent = "MODE ADMIN ‚Äî Pilotage complet";
    }
    if(welcomeSub){
      welcomeSub.textContent = "Acc√®s maison m√®re : CORE, finances, flux et modules DIGIY reli√©s.";
    }
    if(coreBadge){
      coreBadge.textContent = "Admin ‚Ä¢ ACTIF";
    }
    if(coreBody){
      coreBody.textContent = "Acc√®s privil√©gi√© : vision globale, monitoring et strat√©gie DIGIY (proto).";
    }
    if(coreMini){
      coreMini.textContent = "R√©serv√© √† l‚Äôadministrateur";
    }
    if(coreModule){
      coreModule.classList.add("admin-core");
    }

    document.title = "DIGIY HUB ‚Äî MODE ADMIN";
  }

  function updateUserUI(){
    const userNameEl = document.getElementById("userName");
    const userRoleEl = document.getElementById("userRole");
    const welcomeTitle = document.getElementById("welcomeTitle");
    const welcomeSub = document.getElementById("welcomeSub");
    const walletOwnerEl = document.getElementById("walletOwner");
    const avatarEl = document.getElementById("userAvatar");

    if(currentUser){
      const role = currentUser.role || "profil";
      const name = currentUser.name || "Compte DIGIY";
      const phone = currentUser.phone || "‚Äî";

      userNameEl.textContent = name;
      userRoleEl.textContent = getRoleLabel(role);
      welcomeTitle.textContent = "Bonjour, " + name + " üëã";
      if(!welcomeSub.textContent){
        welcomeSub.textContent = "Bienvenue dans votre HUB DIGIY. Vous pouvez ouvrir vos services depuis cet espace central.";
      }
      walletOwnerEl.textContent = "Compte : " + phone;

      const initial = name.trim().charAt(0).toUpperCase() || "üë§";
      avatarEl.textContent = initial;

      if(role === "admin"){
        applyAdminMode();
      }
    }else{
      userNameEl.textContent = "Invit√© DIGIY";
      userRoleEl.textContent = "Connectez-vous depuis la page d‚Äôinscription";
      welcomeTitle.textContent = "Bienvenue dans votre HUB DIGIY";
      welcomeSub.textContent = "Connectez-vous pour profiter pleinement des modules DIGIY.";
      walletOwnerEl.textContent = "Compte : invit√© (wallet local)";
      avatarEl.textContent = "üë§";
    }
  }

  function loadLocalWallet(){
    try{
      const raw = localStorage.getItem(STORAGE_WALLET_KEY);
      if(!raw) return 0;
      return Number(raw) || 0;
    }catch(e){
      return 0;
    }
  }

  function saveLocalWallet(value){
    walletBalance = value;
    try{
      localStorage.setItem(STORAGE_WALLET_KEY, String(value));
    }catch(e){}
  }

  function syncWalletFromFirebase(){
    if(!firebaseReady || !walletPath) return;

    firebaseDB.ref(walletPath + "/balance").get()
      .then(snapshot => {
        if(snapshot.exists()){
          const remoteBalance = Number(snapshot.val() || 0);
          walletBalance = remoteBalance;
          saveLocalWallet(walletBalance);
          lastActivity = "Solde synchronis√© depuis Firebase";
          updateWalletUI();
        }else{
          firebaseDB.ref(walletPath).set({ balance: 0, updatedAt: firebase.database.ServerValue.TIMESTAMP });
          walletBalance = 0;
          saveLocalWallet(walletBalance);
          lastActivity = "Wallet cr√©√© sur Firebase";
          updateWalletUI();
        }
      })
      .catch(err => {
        console.error("Erreur lecture wallet Firebase:", err);
        lastActivity = "Erreur connexion Firebase (wallet)";
        updateWalletUI();
      });
  }

  function saveWalletToFirebase(){
    if(!firebaseReady || !walletPath) return;
    firebaseDB.ref(walletPath).set({
      balance: walletBalance,
      updatedAt: firebase.database.ServerValue.TIMESTAMP
    }).catch(err => {
      console.error("Erreur √©criture wallet Firebase:", err);
    });
  }

  function updateWalletUI(){
    const walletBalanceEl = document.getElementById("walletBalance");
    const lastActivityEl = document.getElementById("lastActivity");
    walletBalanceEl.textContent = formatCurrency(walletBalance);
    lastActivityEl.textContent = "Derni√®re action : " + lastActivity;
  }

  function simulateTopUp(amount){
    amount = Number(amount || 0);
    walletBalance = loadLocalWallet() + amount;
    saveLocalWallet(walletBalance);
    lastActivity = "+ " + formatCurrency(amount);

    if(firebaseReady && walletPath){
      saveWalletToFirebase();
    }

    updateWalletUI();
  }

  function resetWallet(){
    walletBalance = 0;
    saveLocalWallet(walletBalance);
    lastActivity = "Reset du wallet";

    if(firebaseReady && walletPath){
      saveWalletToFirebase();
    }

    updateWalletUI();
  }

  function openSideMenu(){
    document.getElementById("sideMenu").classList.add("open");
    document.getElementById("sideMenuOverlay").classList.add("open");
  }

  function closeSideMenu(){
    document.getElementById("sideMenu").classList.remove("open");
    document.getElementById("sideMenuOverlay").classList.remove("open");
  }

  function scrollToTop(){
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function openModule(key){
    const url = LINKS[key] || "#";
    if(!url || url === "#"){
      alert("Ce module n‚Äôest pas encore branch√©. On le connectera dans une prochaine √©tape.");
      return;
    }
    window.open(url, "_blank");
  }

  function logoutUser(){
    if(!confirm("Se d√©connecter du HUB et revenir √† la page d‚Äôinscription ?")) return;
    try{
      localStorage.removeItem(STORAGE_USER_KEY);
    }catch(e){}
    window.location.href = "index.html";
  }

  document.addEventListener("DOMContentLoaded", () => {
    currentUser = loadUser();
    updateUserUI();

    initFirebase();

    walletPath = getWalletPathForUser(currentUser);
    walletBalance = loadLocalWallet();
    updateWalletUI();

    if(firebaseReady && walletPath){
      syncWalletFromFirebase();
    }else if(!walletPath){
      const walletOwnerEl = document.getElementById("walletOwner");
      walletOwnerEl.textContent = "Compte : invit√© (wallet local uniquement)";
      document.getElementById("walletStatus").textContent = "Mode d√©mo (pas de t√©l√©phone pour lier PAY)";
    }
  });
</script>

</body>
</html>
