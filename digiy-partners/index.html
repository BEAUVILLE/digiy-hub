<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>DIGIY PARTENAIRE — Pré-inscription</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{
      margin:0;
      padding:0;
      font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
      background:#020617;
      color:#e5e7eb;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
    }
    .card{
      background:#020617;
      border:1px solid #1f2937;
      box-shadow:0 20px 45px rgba(15,23,42,0.9);
      border-radius:16px;
      padding:24px 20px;
      width:100%;
      max-width:420px;
    }
    h1{
      font-size:1.7rem;
      margin:0 0 4px;
      color:#facc15;
      font-weight:800;
    }
    p.subtitle{
      margin:0 0 16px;
      font-size:0.9rem;
      color:#9ca3af;
      font-weight:600;
    }
    label{
      display:block;
      font-size:0.85rem;
      margin-bottom:4px;
      color:#e5e7eb;
      font-weight:600;
    }
    input,select{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid #374151;
      background:#020617;
      color:#e5e7eb;
      font-size:1rem;
      outline:none;
    }
    button{
      width:100%;
      padding:12px;
      border-radius:999px;
      border:none;
      background:#f97316;
      color:#020617;
      font-weight:800;
      font-size:1.1rem;
      cursor:pointer;
      margin-top:14px;
    }
    .status{
      margin-top:12px;
      font-size:0.9rem;
      font-weight:600;
    }
    .ok{ color:#22c55e; }
    .err{ color:#ef4444; }
  </style>
</head>
<body>
  <div class="card">
    <h1>DIGIY PARTENAIRE</h1>
    <p class="subtitle">Pré-inscription • Chauffeur • Hébergement • Resto • Boutique</p>

    <form id="partnerForm">
      <label for="full_name">Nom complet *</label>
      <input id="full_name" required>

      <label for="phone">Téléphone (WhatsApp) *</label>
      <input id="phone" required placeholder="+221…">

      <label for="preferred_module">Module souhaité *</label>
      <select id="preferred_module" required>
        <option value="">Choisir…</option>
        <option value="driver">DIGIY DRIVER (chauffeur)</option>
        <option value="loc">DIGIY LOC (hébergement)</option>
        <option value="resto">DIGIY RESTO</option>
        <option value="market">DIGIY MARKET</option>
        <option value="jobs">DIGIY JOBS</option>
        <option value="pos">DIGIY POS</option>
      </select>

      <button type="submit">Envoyer la demande</button>
      <div id="statusMsg" class="status"></div>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://wesqmwjjtsefyjnluosj.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_2KVRayr3oWcewu0Y7xMkOQ_D6522h1E";

    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const form = document.getElementById("partnerForm");
    const statusMsg = document.getElementById("statusMsg");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusMsg.textContent = "";
      
      const full_name = document.getElementById("full_name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const preferred_module = document.getElementById("preferred_module").value;

      if (!full_name || !phone || !preferred_module){
        statusMsg.textContent = "Merci de remplir les champs obligatoires.";
        statusMsg.className = "status err";
        return;
      }

      const { error } = await supabaseClient
        .from("partners")
        .insert([{ full_name, phone, preferred_module }]);

      if (error){
        statusMsg.textContent = "Erreur : " + error.message;
        statusMsg.className = "status err";
      } else {
        form.reset();
        statusMsg.textContent = "✔ Pré-inscription envoyée avec succès !";
        statusMsg.className = "status ok";
      }
    });
  </script>
</body>
</html>
