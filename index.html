<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark" />
  <title>DIGIY HUB ‚ôæÔ∏è ‚Äî 0% Commission</title>
  <meta name="description" content="DIGIY HUB ‚Äî Toutes les apps DIGIY au m√™me endroit. 0% commission, paiement direct au pro." />

  <!-- PWA -->
  <meta name="theme-color" content="#0A0E1A" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="./icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    :root{
      --bg:#070B14;
      --card:#0B1224;
      --card2:#0E1730;
      --line:rgba(255,255,255,.12);
      --text:#EAF2FF;
      --muted:rgba(234,242,255,.72);
      --gold:#FACC15;
      --green:#22C55E;
      --orange:#F97316;
      --red:#EF4444;
      --radius:20px;

      /* Lisibilit√© (gros texte par d√©faut) */
      --fs0:14px;
      --fs1:16px;
      --fs2:18px;
      --fs3:22px;
      --fs4:28px;
      --fs5:36px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 10% -10%, rgba(250,204,21,.22), transparent 60%),
        radial-gradient(900px 500px at 110% 0%, rgba(34,197,94,.18), transparent 60%),
        radial-gradient(900px 500px at 50% 120%, rgba(249,115,22,.10), transparent 55%),
        var(--bg);
    }

    a{color:inherit; text-decoration:none}
    .wrap{max-width:980px; margin:0 auto; padding:18px 14px 40px}

    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: linear-gradient(to bottom, rgba(7,11,20,.85), rgba(7,11,20,.55));
      border-bottom:1px solid var(--line);
    }
    .topbar{
      max-width:980px; margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px;
      gap:10px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      min-width: 0;
    }
    .logo{
      width:42px; height:42px; border-radius:14px;
      background: radial-gradient(circle at 30% 30%, rgba(250,204,21,.95), rgba(250,204,21,.25) 55%, rgba(34,197,94,.12) 100%);
      box-shadow: 0 12px 34px rgba(250,204,21,.12);
      border:1px solid rgba(250,204,21,.25);
      flex:0 0 auto;
    }
    .brand h1{
      margin:0;
      font-size:var(--fs3);
      letter-spacing:.2px;
      line-height:1.05;
      font-weight:900;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand .sub{
      margin:2px 0 0;
      font-size:var(--fs1);
      color:var(--muted);
      font-weight:700;
    }

    .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      font-size:var(--fs2);
      font-weight:900;
      letter-spacing:.2px;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      line-height:1;
      min-height:46px;
    }
    .btn:hover{background: rgba(255,255,255,.06)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      border-color: rgba(250,204,21,.28);
      background: linear-gradient(180deg, rgba(250,204,21,.16), rgba(255,255,255,.03));
      box-shadow: 0 16px 40px rgba(250,204,21,.10);
    }
    .btn.green{
      border-color: rgba(34,197,94,.28);
      background: linear-gradient(180deg, rgba(34,197,94,.16), rgba(255,255,255,.03));
      box-shadow: 0 16px 40px rgba(34,197,94,.10);
    }

    .hero{
      margin-top:16px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius: var(--radius);
      padding:18px 16px;
      overflow:hidden;
      position:relative;
    }
    .hero h2{
      margin:0 0 6px;
      font-size:var(--fs5);
      font-weight:1000;
      letter-spacing:.2px;
      line-height:1.05;
    }
    .hero p{
      margin:0;
      font-size:var(--fs2);
      color:var(--muted);
      font-weight:800;
      line-height:1.35;
      max-width: 70ch;
    }
    .chips{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    .chip{
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      font-size:var(--fs1);
      font-weight:900;
      color: rgba(234,242,255,.88);
      display:inline-flex; gap:8px; align-items:center;
    }

    .grid{
      margin-top:16px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
    }
    .card{
      grid-column: span 6;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      padding:16px;
      min-height:120px;
      position:relative;
      overflow:hidden;
    }
    .card.big{grid-column: span 12}
    .card h3{
      margin:0 0 6px;
      font-size:var(--fs4);
      font-weight:1000;
      letter-spacing:.2px;
    }
    .card p{
      margin:0 0 12px;
      font-size:var(--fs2);
      color:var(--muted);
      font-weight:800;
      line-height:1.35;
    }
    .card .row{display:flex; gap:10px; flex-wrap:wrap}

    .note{
      margin-top:14px;
      border:1px dashed rgba(250,204,21,.35);
      background: rgba(250,204,21,.06);
      border-radius: var(--radius);
      padding:14px 14px;
      font-size:var(--fs2);
      font-weight:900;
      color: rgba(234,242,255,.92);
    }

    footer{
      margin-top:18px;
      color: rgba(234,242,255,.65);
      font-size: var(--fs1);
      font-weight:800;
      text-align:center;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0; z-index:1000;
      display:none;
      align-items:flex-end;
      justify-content:center;
      background: rgba(0,0,0,.55);
      padding:18px;
    }
    .modal.open{display:flex}
    .sheet{
      width:min(720px, 100%);
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(11,18,36,.98), rgba(7,11,20,.98));
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      overflow:hidden;
    }
    .sheet header{
      position:unset;
      backdrop-filter:none;
      background: transparent;
      border-bottom:1px solid var(--line);
    }
    .sheet .hd{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 14px;
      gap:10px;
    }
    .sheet .hd strong{
      font-size:var(--fs3);
      font-weight:1000;
      letter-spacing:.2px;
    }
    .sheet .bd{padding:14px}
    .qrbox{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 18px;
      padding:14px;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 14px;
      color: rgba(234,242,255,.80);
      font-weight:800;
      word-break:break-all;
    }

    /* Responsive */
    @media (max-width: 720px){
      .card{grid-column: span 12}
      .hero h2{font-size: 34px}
    }
  </style>
</head>

<body>
  <header>
    <div class="topbar">
      <div class="brand" aria-label="DIGIY HUB">
        <div class="logo" aria-hidden="true"></div>
        <div style="min-width:0">
          <h1>DIGIY HUB ‚ôæÔ∏è</h1>
          <div class="sub">Paiement direct ‚Ä¢ 0% commission ‚Ä¢ Terrain</div>
        </div>
      </div>

      <div class="actions">
        <a class="btn primary" href="./core.html" title="Ouvrir le CORE (admin/partner)">ü¶Ö CORE</a>
        <a class="btn" href="./digiylyfe.html" title="Accueil DIGIYLYFE">‚ôæÔ∏è Accueil</a>
        <button class="btn green" id="btnInstall" type="button" style="display:none">‚¨áÔ∏è Installer</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <h2>Tout DIGIY. Un seul hub.</h2>
      <p>
        Tu choisis l‚Äôapp. Le client te contacte direct. Tu gardes ton chiffre.  
        <strong style="color:rgba(250,204,21,.95)">0% commission</strong>.
      </p>

      <div class="chips" aria-label="Points cl√©s">
        <span class="chip">‚ö° Rapide</span>
        <span class="chip">üîí Simple</span>
        <span class="chip">üí¨ WhatsApp direct</span>
        <span class="chip">üí≥ Paiement direct</span>
        <span class="chip">‚ôæÔ∏è NDIMBAL entraide</span>
      </div>
    </section>

    <section class="grid" aria-label="Modules">
      <!-- NDIMBAL -->
      <article class="card big">
        <h3>‚ôæÔ∏è NDIMBAL</h3>
        <p>Naka nga def ? Besoin d‚Äôaide, mission rapide, entraide. Carte terrain + acc√®s direct.</p>
        <div class="row">
          <a class="btn primary" href="https://beauville.github.io/digiy-mdimbal-map/" rel="noopener" target="_blank">üó∫Ô∏è Ouvrir NDIMBAL MAP</a>
          <button class="btn" id="btnNDQ" type="button">üì≤ QR NDIMBAL</button>
        </div>
      </article>

      <!-- DIGIY J√ãF -->
      <article class="card">
        <h3>‚ôæÔ∏è DIGIY J√ãF</h3>
        <p>Publier une mission terrain. WhatsApp direct. Efficace pour jeunes, √©tudiants, communaut√©s.</p>
        <div class="row">
          <a class="btn primary" href="./digiy-jef.html">‚ûï Publier mission</a>
          <a class="btn" href="./digiy-jef-lite.html">‚ö° J√ãF Lite</a>
        </div>
      </article>

      <!-- JOBS -->
      <article class="card">
        <h3>üíº DIGIY JOBS</h3>
        <p>Offres & missions. Acc√®s simple. Orient√© terrain.</p>
        <div class="row">
          <a class="btn primary" href="./digiy-jobs.html">üîé Ouvrir JOBS</a>
          <a class="btn" href="./jef-admin.html">üõ°Ô∏è Admin</a>
        </div>
      </article>

      <!-- PAY -->
      <article class="card">
        <h3>üí≥ DIGIY PAY</h3>
        <p>Recevoir / payer. Logique ‚Äúpaiement direct au pro‚Äù.</p>
        <div class="row">
          <a class="btn primary" href="./digiy-pay.html">üí≥ Ouvrir DIGIY PAY</a>
          <a class="btn" href="https://pay.digiylyfe.com" rel="noopener" target="_blank">üåç pay.digiylyfe.com</a>
        </div>
      </article>

      <!-- Tools -->
      <article class="card">
        <h3>üß∞ Tools</h3>
        <p>Install PWA, g√©n√©rateur d‚Äôic√¥nes, pages utilitaires.</p>
        <div class="row">
          <a class="btn primary" href="./pwa-install.html">‚¨áÔ∏è PWA Install</a>
          <a class="btn" href="./generateur-icones-pwa.html">üñºÔ∏è Ic√¥nes PWA</a>
        </div>
      </article>

      <!-- Inscription -->
      <article class="card">
        <h3>üßæ Inscription</h3>
        <p>Cr√©er un acc√®s / onboarding propre.</p>
        <div class="row">
          <a class="btn primary" href="./inscription-digiylyfe.html">üßæ Ouvrir inscription</a>
          <button class="btn" id="btnStatus" type="button">üõ∞Ô∏è Statut PWA</button>
        </div>
      </article>
    </section>

    <div class="note" id="statusBox" style="display:none">
      <div style="font-weight:1000; margin-bottom:6px">üõ∞Ô∏è Statut</div>
      <div id="statusText" style="font-weight:900; color:rgba(234,242,255,.82)"></div>
    </div>

    <footer>
      DIGIYLYFE ‚ôæÔ∏è ‚Äî Built on the ground. Built to last.
    </footer>
  </main>

  <!-- Modal QR NDIMBAL -->
  <div class="modal" id="qrModal" role="dialog" aria-modal="true" aria-label="QR NDIMBAL">
    <div class="sheet">
      <header>
        <div class="hd">
          <strong>üì≤ QR ‚Äî NDIMBAL MAP</strong>
          <button class="btn" id="btnCloseQR" type="button">‚úñ Fermer</button>
        </div>
      </header>
      <div class="bd">
        <div class="qrbox">
          <div style="display:flex; gap:14px; flex-wrap:wrap; align-items:center; justify-content:space-between">
            <div>
              <div style="font-size:var(--fs2); font-weight:1000; margin-bottom:6px">Lien</div>
              <div class="mono" id="ndimbalUrlText"></div>
              <div style="height:10px"></div>
              <button class="btn primary" id="btnCopyLink" type="button">üìã Copier le lien</button>
            </div>

            <!-- QR (g√©n√©r√© via API simple) -->
            <div style="text-align:center; min-width:220px">
              <div style="font-size:var(--fs2); font-weight:1000; margin-bottom:6px">QR</div>
              <img id="ndimbalQrImg" alt="QR NDIMBAL" width="220" height="220"
                   style="border-radius:18px; border:1px solid var(--line); background:rgba(255,255,255,.03)" />
              <div style="margin-top:8px; font-size:var(--fs1); color:var(--muted); font-weight:800">
                Scan ‚Üí ouvre NDIMBAL MAP
              </div>
            </div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div style="border:1px solid var(--line); border-radius:18px; padding:12px; background:rgba(255,255,255,.02)">
          <div style="font-size:var(--fs2); font-weight:1000; margin-bottom:6px">Astuce terrain</div>
          <div style="font-size:var(--fs2); font-weight:900; color:rgba(234,242,255,.82); line-height:1.35">
            Imprime ce QR, colle-le au comptoir. Le client scanne ‚Üí WhatsApp direct / carte / aide.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      "use strict";

      const NDIMBAL_URL = "https://beauville.github.io/digiy-mdimbal-map/";

      // Elements
      const btnNDQ     = document.getElementById("btnNDQ");
      const qrModal    = document.getElementById("qrModal");
      const btnCloseQR = document.getElementById("btnCloseQR");
      const ndText     = document.getElementById("ndimbalUrlText");
      const qrImg      = document.getElementById("ndimbalQrImg");
      const btnCopy    = document.getElementById("btnCopyLink");

      const btnInstall = document.getElementById("btnInstall");
      const btnStatus  = document.getElementById("btnStatus");
      const statusBox  = document.getElementById("statusBox");
      const statusText = document.getElementById("statusText");

      // --------- QR Modal (NDIMBAL) ----------
      function openQR(){
        ndText.textContent = NDIMBAL_URL;

        // QR via service public simple (stable). Si tu pr√©f√®res, on le remplacera par ton g√©n√©rateur interne.
        const enc = encodeURIComponent(NDIMBAL_URL);
        qrImg.src = "https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=" + enc;

        qrModal.classList.add("open");
      }
      function closeQR(){
        qrModal.classList.remove("open");
      }
      btnNDQ?.addEventListener("click", openQR);
      btnCloseQR?.addEventListener("click", closeQR);
      qrModal?.addEventListener("click", (e)=>{ if(e.target === qrModal) closeQR(); });
      document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeQR(); });

      btnCopy?.addEventListener("click", async ()=>{
        try{
          await navigator.clipboard.writeText(NDIMBAL_URL);
          btnCopy.textContent = "‚úÖ Copi√©";
          setTimeout(()=> btnCopy.textContent = "üìã Copier le lien", 1200);
        }catch{
          alert("Copie impossible ‚Äî fais un copier/coller manuel.");
        }
      });

      // --------- PWA / Service Worker ----------
      async function registerSW(){
        if(!("serviceWorker" in navigator)) return { ok:false, reason:"no-sw" };

        // scope = dossier courant (GH pages friendly)
        const swUrl = new URL("./service-worker.js", location.href);
        try{
          const reg = await navigator.serviceWorker.register(swUrl, { scope: "./" });
          return { ok:true, reg };
        }catch(err){
          return { ok:false, reason:String(err && err.message ? err.message : err) };
        }
      }

      let deferredPrompt = null;

      window.addEventListener("beforeinstallprompt", (e)=>{
        e.preventDefault();
        deferredPrompt = e;
        if(btnInstall) btnInstall.style.display = "inline-flex";
      });

      btnInstall?.addEventListener("click", async ()=>{
        if(!deferredPrompt) return;
        deferredPrompt.prompt();
        try{ await deferredPrompt.userChoice; }catch{}
        deferredPrompt = null;
        btnInstall.style.display = "none";
      });

      // --------- Status ----------
      function setStatus(lines){
        statusBox.style.display = "block";
        statusText.innerHTML = lines.map(s => "‚Ä¢ " + s).join("<br/>");
      }

      btnStatus?.addEventListener("click", async ()=>{
        const online = navigator.onLine ? "En ligne ‚úÖ" : "Hors-ligne ‚ö†Ô∏è";
        const pwa = window.matchMedia("(display-mode: standalone)").matches ? "Install√©e (standalone) ‚úÖ" : "Mode navigateur üåç";

        let sw = "SW: non";
        if("serviceWorker" in navigator){
          const reg = await navigator.serviceWorker.getRegistration();
          sw = reg ? "SW: actif ‚úÖ" : "SW: pas encore";
        }

        setStatus([online, pwa, sw]);
      });

      // Boot
      (async ()=>{
        const r = await registerSW();
        // Status auto discret (pas de spam)
        if(!r.ok && r.reason !== "no-sw"){
          // console only
          console.warn("SW register failed:", r.reason);
        }
      })();
    })();
  </script>
</body>
</html>
